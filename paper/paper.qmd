---
title: "Toronto Paramedic Services"
subtitle: "A deeper look into what is driving Emergency Medical Services (EMS) demand in Toronto"
author: 
  - Julia Lee
thanks: "Code and data are available at: https://github.com/JuliaJLee/Toronto_Paramedic_Services.git"
date: today
date-format: long
abstract: "In 2023, there were over 1,000 cases where an ambulance was unavailable to respond to an emergency call. This calls for urgent action because in emergency situations, every moment is critical. By examining Paramedic Services Incident Data (2017-2022) provided by Toronto Paramedic Services, the following anaylsis aims to identify the key drivers of Emergency Medical Services (EMS) demand within Toronto to help inform more effective strategies for managing EMS demand. In short, medical emergencies and vehicle accidents appear to be the most prominent drivers of EMS demand, suggesting that strategies that seek to better manage demand in these areas may enhance the overall efficiency of paramedic services."
format: pdf
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(tinytex)
library(knitr)
library(ggplot2)
library(dplyr)
```


# Introduction

"In case of an emergency, please call 911." From building walls to road signs, this is a message that appears almost everywhere, and it instills the idea that no matter the circumstance, there will always be emergency services available to help. However, research shows that this is not the case. A report on Toronto's paramedic services highlights that there were no ambulances available to over 1,000 calls in 2023 @auditorreport. With drastically increasing wait times for those who required Eemergency Medical Services (EMS), it is crucial to understand why paramedic services are unable to keep up with a seemingly growing demand for EMS.

In response to this rising challenge, the report posits that in order to elevate the "efficiency and effectiveness" @auditorreport of Toronto's paramedic services, further research on how to manage EMS demand is needed. Thus, this paper seeks to investigate the factors that seem to be driving EMS demand within Toronto. Using Paramedic Services Incident Data offered by Toronto Paramedic Services, the aim is to identify which types of emergencies (e.g. medical emergencies or vehicle accidents) strongly drive EMS demand. Knowing this can help inform effective strategies that allocate resources to these drivers for better EMS demand management. 

With this, this paper first examines the total number of emergency calls made from 2017 to 2022 to better understand how EMS demand has changed over time. Then, it looks at EMS demand through five different incident types as outlined by Toronto Paramedic Services to determine which of these five incident types are key drivers of the total EMS demand. As a result, this analysis finds that medical emergencies and vehicle accidents are notable drivers of EMS demand within Toronto. 

In what follows, the paper will define the data that was used within this analysis, provide a detailed account of the results, and put forth a discussion of the analysis along with its limitations and next steps.

# Data

Paramedic Services Incident Data (2017-2022) is provided by Toronto Paramedic Services [@torontoparamedicservices]. The records of when a paramedic was dispatched having received a call, they type of incident, the priority level of each incident, the number of paramedic units that arrived at the scene, and the general location of each incident are all updated by hand to the city of Toronto's Open Data portal [@opentorontodata]. 

To simulate, test, download, and clean the Paramedic Services Incident Data (2017-2022), the statistical programming language R was used [@citeR]. Specific libraries that assisted the analysis include `tidyverse` [@tidyverse], `dplyr` [@dplyr], `opendatatoronto` [@opendatatoronto], `tinytex` [@tinytex], `ggplot2` [@ggplot2], and `knitr` [@knitr]. 

The Paramedic Services Incident Data is refreshed annually and contains information on every single incident paramedics have responded to since January 1st to December 31st in 2017 to 2022. For every day of each year, there are multiple records of incidents that have occurred. For every record, there is an ID number, the date and time when a paramedic unit was dispatched, the type of incident, the severity of the incident (priority), the number of paramedic units at the scene, and the general location of the incident. @tbl-rawdata below previews this information for recorded incidents in 2022.

```{r}
#| echo: false
#| message: false
#| label: tbl-rawdata
#| tbl-cap: "Paramedic Services Incident Data for 2022" 

data <- read_csv(here::here("data/raw_data/raw_data_2022.csv"))

data <- 
 data |> 
  select(-...1)

data |>
  slice(1:6) |>
  kable(
    col.names = c("ID", "Dispatch Time", "Incident Type", "Priority", 
                  "Units Arrived", "Location"),
    digits = 1,
    booktabs = TRUE,
    linesep = "",
    align = c("l", "l", "l", "l", "l", "l"),
    format.args = list(big.mark = ",")
  )

```

For this analysis, the variables of interest within this analysis are the different incident types that are recorded. This dataset lists five different incident types: medical emergencies, vehicle accidents, emergency transfers, fires, and airport standbys. These types refer to different circumstances under which individuals may call 911 for EMS. 

# Results

## EMS Demand from 2017 to 2022

```{r}
#| echo: false 
#| message: false
#| label: fig-totalemsdemand
#| fig-cap: Total EMS Demand for Each Year between 2017 and 2022

data <- read_csv(here::here("data/analysis_data/analysis_data.csv"))

ggplot(data, aes(x = Year, y = Total_Emergency_Calls)) + 
  geom_line(linewidth = 0.5, colour="black") + geom_point(colour = "black") +
  ylim(200000,300000) + theme_light() + 
  ggtitle("EMS Demand From 2017 to 2022") +
  labs(x = "Year", y = "Demand for EMS", caption = "Data Source: Toronto Paramedic Services") + 
  theme(plot.title = element_text(hjust = 0.5)) 
```
@fig-totalemsdemand displays the total number of emergency calls for each year. The total number of emergency calls appears to increase in 2020 after a notable decrease in 2019. This pattern likely reflects the the onset of the covid-19 pandemic. Though the number of emergency calls appears to fluctuate over the years, the change is not drastic, indicating that there has consistently been a heightened demand for EMS within Toronto.

## EMS Demand from 2017 to 2022 Based on Incident Type

To further unpack what is driving this consistent demand, the calls for individual incident type are also considered. @fig-incidentemsdemand illustrates the number of emergency calls for each incident type along with the total number of emergency calls. Based on @fig-incidentemsdemand, demands for EMS are markedly higher for medical emergencies than any other incident type, suggesting that medical circumstances are the key drivers that propel EMS demand. 

By zooming into @fig-incidentemsdemand with @fig-incidentemsdemandzoom below, a clearer look at the other incident types is provided. With @fig-incidentemsdemandzoom, it becomes clear that a second prominent driver of EMS demand is vehicle accidents, implying that a fairly large portion of the emergency calls that are dispatched to paramedic services comes from incidents on the road.

```{r}
#| echo: false 
#| message: false
#| label: fig-incidentemsdemand
#| fig-cap: EMS Demand for Each Year between 2017 and 2022

data <- read_csv(here::here("data/analysis_data/analysis_data.csv"))

data |>
  pivot_longer(
    cols = c("Total_Emergency_Calls", "Medical_Emergency_Calls", "Vehicle_Accident_Calls", "Emergency_Transfer_Calls", "Fire_Calls", "Airport_Standby_Calls"),
    names_to = "series",
    values_to = "value"
  ) |>
  ggplot(mapping = aes(x = Year, y = value, colour = series)) +
  geom_line() +
  geom_point() +
  theme_light() +
  labs(
    x = "Year", colour = "Incident Type",
    caption = "Data Source: Toronto Paramedic Services"
  ) +
  scale_colour_brewer(palette = "Set3", labels = c("Airport Standbys", "Emergency Transfers", "Fires", "Medical Emergencies", "Total Emergency Calls", "Vehicle Accidents")) +
  ggtitle("EMS Demand (2017-2022) Based on Incident Type") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ylim(0,300000) + scale_y_continuous(name = "Demand for EMS", labels = scales::comma)
```
```{r}
#| echo: false 
#| message: false
#| label: fig-incidentemsdemandzoom
#| fig-cap: EMS Demand for Each Year between 2017 and 2022

data <- read_csv(here::here("data/analysis_data/analysis_data.csv"))

data |>
  pivot_longer(
    cols = c("Vehicle_Accident_Calls", "Emergency_Transfer_Calls", "Fire_Calls", "Airport_Standby_Calls"),
    names_to = "series",
    values_to = "value"
  ) |>
  ggplot(mapping = aes(x = Year, y = value, colour = series)) +
  geom_line() +
  geom_point() +
  theme_light() +
  labs(
    x = "Year", colour = "Incident Type",
    caption = "Data Source: Toronto Paramedic Services"
  ) +
  scale_colour_brewer(palette = "Set3", labels = c("Airport Standbys", "Emergency Transfers", "Fires", "Vehicle Accidents")) +
  ggtitle("EMS Demand (2017-2022) Based on Incident Type") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ylim(0,20000) + scale_y_continuous(name = "Demand for EMS", labels = scales::comma)
```

## Mapping EMS Demand 

```{r}
#| echo: false 
#| message: false
#| label: fig-map
#| fig-cap: EMS Demand Across Toronto Forward Sortation Areas (Based on data from 2022)

library(maps)
library(sf)

# Reading in the shapefile

toronto_forward_sortation_areas <- st_read("~/Toronto_Paramedic_Services/data/TorontoForwardSortationAreas")
#view(toronto_forward_sortation_areas)

# Reading in the paramedic services data

map_data <- read_csv(here::here("data/analysis_data/analysis_data_FOR_MAP.csv"))
#view(map_data)

# Test to see if shapefile produces a map

#ggplot(toronto_forward_sortation_areas) + 
  #geom_sf()

# Merge map_data and toronto_forward_sortation_areas by the column "CFSAUID"

merged_map_data <- merge(toronto_forward_sortation_areas, map_data, by = "CFSAUID")
#view(merged_map_data)

# Map the merged data

ggplot(merged_map_data) + 
  geom_sf(aes(fill = "EMS Demand Driver")) +
  labs(title = "EMS Demand Drivers By Forward Sortation Area (FSA)",
         x = "Longitude", y="Latitude", 
       caption = "Data Source: Open Canada 2021 Census - Boundary Files & Toronto Paramedic Services",
       labels = c("Medical Emergencies")) +
  theme_light() + theme(plot.title = element_text(hjust = 0.5))



```


\newpage


# Discussion

As demand for EMS continues to be a challenge, identifying the areas where most of the demand comes from can help better inform strategies to better manage it. To this, the given analysis finds that medical emergencies and vehicle accidents are notable drivers of EMS demand within Toronto. 

Response times for EMS demand have been greatly impacted by offload delays, staffing/training challenges, and traffic congestion [@auditorreport]. With medical emergencies, a shortage of doctors has placed pressure on paramedic services as residents rely on and turn to these services more often [@cbcarticle]. This in turn, increases in offload delays - the time it takes to offload patients into hospitals. Longer offload delays mean longer response times for other incidents. Putting all of this together, a strategy to better manage EMS demand for medical emergencies may be to focus on promoting primary-care providers (i.e. family doctors) and to allocate resources to provide additional health services (e.g. programs to consult with a health-care professional online from home). 

Traffic congestion has been found to increase paramedic response times [@journal], and with the current increase in traffic due to multiple construction projects throughout Toronto, longer paramedic response times and the unavailability of paramedic services can be expected. To efficiently navigate EMS demand for vehicle accidents, strategies may center around accident prevention or effective distribution of resources near accident-prone regions for faster response times. 

Thus, these findings offer a deeper understanding about the underlying factors that can drive EMS demand, and this understanding can further facilitate the exploration of various strategies that allow paramedic services to effectively operate even under high demand.

\newpage


# References
